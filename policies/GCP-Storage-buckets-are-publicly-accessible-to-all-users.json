{
  "policyUpi": "PC-GCP-STO-193",
  "policyId": "1530d5de-34de-4de9-bb0a-82444607fe66",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "high",
  "name": "GCP Storage buckets are publicly accessible to all users",
  "description": "This policy identifies the buckets which are publicly accessible to all users. Enabling public access to Storage buckets enables anybody with a web association to access sensitive information that is critical to business. Access over a whole bucket is controlled by IAM. Access to individual objects within the bucket is controlled by its ACLs.",
  "rule.criteria": "41f7a4b1-cad6-4fbf-b698-1fd11a8869a8",
  "searchModel.query": "config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-storage-buckets-list' AND json.rule = 'iam.bindings[*] size greater than 0 and iam.bindings[*].members[*] any equal allUsers'",
  "recommendation": "1. Login to GCP Portal\n2. In the Navigation menu (Left Panel), Go to Cloud Storage\n3. Click Buckets\n4. Choose the identified Storage bucket whose Permissions or ACLs needs to be modified\n5. Click the Permissions tab\n6. Ensure Bucket access is set to 'Not Public' and the Principles restricted from bucket are 'allUsers'\n7. Review the object level ACLs as applicable",
  "remediable": true,
  "remediation.cliScriptTemplate": "gsutil iam ch -d allUsers gs://${resourceName}",
  "remediation.description": "This CLI command requires 'storage.buckets.getIamPolicy' and 'storage.buckets.setIamPolicy' permissions. Successful execution will revoke 'allUsers' permission access in GCP Storage buckets.",
  "remediation.impact": "Revokes allusers permission access in GCP Storage buckets",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "APRA (CPS 234) Information Security",
    "Australian Energy Sector Cyber Security Framework (AESCSF)",
    "Brazilian Data Protection Law (LGPD)",
    "CCPA 2018",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS v1.0.0 (GCP)",
    "CIS v1.1.0 (GCP)",
    "CIS v1.2.0 (GCP)",
    "CIS v1.3.0 (GCP)",
    "CIS v2.0.0 (GCP) Level 1",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "Cybersecurity Maturity Model Certification (CMMC) v.2.0 (Level 2)",
    "Fedramp (Low)",
    "Fedramp (Moderate)",
    "HITRUST v.9.4.2",
    "ISO 27001:2013",
    "ISO 27002:2022",
    "ISO/IEC 27001:2022",
    "MITRE ATT&CK v10.0",
    "MITRE ATT&CK v12",
    "MITRE ATT&CK v13.0 Cloud IaaS for Enterprise",
    "MITRE ATT&CK v14.0 Cloud IaaS for Enterprise",
    "MITRE ATT&CK v6.3",
    "MITRE ATT&CK v8.2",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-172",
    "New Zealand Information Security Manual (NZISM v3.4)",
    "Otoritas Jasa Keuangan (OJK) 38 POJK.03 2016",
    "PCI DSS v3.2.1",
    "PCI DSS v4.0",
    "PIPEDA",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1"
  ]
}
